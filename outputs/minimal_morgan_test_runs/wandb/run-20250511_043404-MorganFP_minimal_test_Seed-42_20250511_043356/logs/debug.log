2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_setup.py:_flush():70] Current SDK version is 0.19.11
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_setup.py:_flush():70] Configure stats pid to 17882
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_setup.py:_flush():70] Loading settings from /home/ubuntu/.config/wandb/settings
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_setup.py:_flush():70] Loading settings from /home/ubuntu/Tahoeformer/wandb/settings
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_setup.py:_flush():70] Loading settings from environment variables
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:setup_run_log_directory():724] Logging user logs to outputs/minimal_morgan_test_runs/wandb/run-20250511_043404-MorganFP_minimal_test_Seed-42_20250511_043356/logs/debug.log
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to outputs/minimal_morgan_test_runs/wandb/run-20250511_043404-MorganFP_minimal_test_Seed-42_20250511_043356/logs/debug-internal.log
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:init():852] calling init triggers
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'data': {'regions_csv_path': 'data/Enformer_genomic_regions_TSSCenteredGenes_FixedOverlapRemoval.csv', 'pbulk_parquet_path': 'data/pseudoBulk_celllineXdrug_top3k_for_testing.parquet', 'drug_meta_csv_path': 'data/drug_metadata.csv', 'fasta_file_path': '/home/ubuntu/data/hg38.fa', 'enformer_input_seq_length': 49152, 'morgan_fp_radius': 2, 'morgan_fp_nbits': 2048, 'filter_drugs_by_ids': None, 'regions_gene_col': 'gene_name', 'regions_chr_col': 'seqnames', 'regions_start_col': 'starts', 'regions_end_col': 'ends', 'regions_strand_col': None, 'regions_set_col': 'set', 'pbulk_gene_col': 'gene_id', 'pbulk_dose_col': 'drug_dose', 'pbulk_expr_col': 'expression', 'pbulk_cell_line_col': 'cell_line', 'drug_meta_id_col': 'drug', 'drug_meta_smiles_col': 'canonical_smiles', 'pbulk_drug_col': 'drug_id'}, 'model': {'enformer_model_name': 'EleutherAI/enformer-official-rough', 'enformer_target_length': -1, 'num_output_tracks_enformer_head': 1, 'morgan_fingerprint_dim': 2048, 'dose_input_dim': 1, 'fusion_hidden_dim': 256, 'final_output_tracks': 1, 'learning_rate': 5e-06, 'loss_alpha': 1.0, 'weight_decay': 0.01, 'eval_gene_sets': None}, 'training': {'batch_size': 2, 'num_workers': 0, 'pin_memory': False, 'max_epochs': 3, 'gpus': [0], 'accelerator': 'auto', 'strategy': 'auto', 'precision': 'bf16-mixed', 'val_check_interval': 1.0, 'limit_train_batches': 1.0, 'limit_val_batches': 1.0, 'limit_test_batches': 1.0, 'deterministic': True, 'seed': 42, 'gradient_clip_val': 0.05, 'accumulate_grad_batches': 1}, 'logging': {'wandb_project': 'tahoeformer', 'wandb_entity': None, 'save_dir': 'outputs/minimal_morgan_test_runs', 'checkpoint_monitor_metric': 'validation_pearson_epoch', 'checkpoint_monitor_mode': 'max', 'save_top_k': 1, 'early_stopping_metric': 'validation_pearson_epoch', 'early_stopping_mode': 'max', 'early_stopping_patience': 5}, 'experiment_name': 'MorganFP_minimal_test', 'use_wandb': True, 'validate_before_train': True, 'delete_checkpoint_after_run': True, 'run_name': 'MorganFP_minimal_test_Seed-42_20250511_043356', '_wandb': {}}
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:init():893] starting backend
2025-05-11 04:34:04,082 INFO    MainThread:17882 [wandb_init.py:init():897] sending inform_init request
2025-05-11 04:34:04,084 INFO    MainThread:17882 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-05-11 04:34:04,084 INFO    MainThread:17882 [wandb_init.py:init():907] backend started and connected
2025-05-11 04:34:04,085 INFO    MainThread:17882 [wandb_init.py:init():1005] updated telemetry
2025-05-11 04:34:04,089 INFO    MainThread:17882 [wandb_init.py:init():1029] communicating run to backend with 90.0 second timeout
2025-05-11 04:34:04,413 INFO    MainThread:17882 [wandb_init.py:init():1104] starting run threads in backend
2025-05-11 04:34:04,586 INFO    MainThread:17882 [wandb_run.py:_console_start():2573] atexit reg
2025-05-11 04:34:04,586 INFO    MainThread:17882 [wandb_run.py:_redirect():2421] redirect: wrap_raw
2025-05-11 04:34:04,586 INFO    MainThread:17882 [wandb_run.py:_redirect():2490] Wrapping output streams.
2025-05-11 04:34:04,586 INFO    MainThread:17882 [wandb_run.py:_redirect():2513] Redirects installed.
2025-05-11 04:34:04,588 INFO    MainThread:17882 [wandb_init.py:init():1150] run started, returning control to user process
2025-05-11 04:34:04,949 INFO    MainThread:17882 [wandb_run.py:_config_callback():1436] config_cb None None {'learning_rate': 5e-06, 'loss_alpha': 1.0, 'weight_decay': 0.01, 'eval_gene_sets': None, 'enformer_model_name': 'EleutherAI/enformer-official-rough', 'enformer_target_length': -1, 'num_output_tracks_enformer_head': 1, 'morgan_fingerprint_dim': 2048, 'dose_input_dim': 1, 'fusion_hidden_dim': 256, 'final_output_tracks': 1}
2025-05-11 04:34:10,033 INFO    MainThread:17882 [wandb_run.py:_config_callback():1436] config_cb None None {'learning_rate': 5e-06, 'loss_alpha': 1.0, 'weight_decay': 0.01, 'eval_gene_sets': None, 'enformer_model_name': 'EleutherAI/enformer-official-rough', 'enformer_target_length': -1, 'num_output_tracks_enformer_head': 1, 'morgan_fingerprint_dim': 2048, 'dose_input_dim': 1, 'fusion_hidden_dim': 256, 'final_output_tracks': 1}
2025-05-11 04:38:17,064 INFO    MainThread:17882 [wandb_run.py:_config_callback():1436] config_cb None None {'learning_rate': 5e-06, 'loss_alpha': 1.0, 'weight_decay': 0.01, 'eval_gene_sets': None, 'enformer_model_name': 'EleutherAI/enformer-official-rough', 'enformer_target_length': -1, 'num_output_tracks_enformer_head': 1, 'morgan_fingerprint_dim': 2048, 'dose_input_dim': 1, 'fusion_hidden_dim': 256, 'final_output_tracks': 1}
2025-05-11 04:38:22,331 INFO    MainThread:17882 [wandb_run.py:_finish():2321] finishing run qhuang20-n-a/tahoeformer/MorganFP_minimal_test_Seed-42_20250511_043356
2025-05-11 04:38:22,331 INFO    MainThread:17882 [wandb_run.py:_atexit_cleanup():2538] got exitcode: 0
2025-05-11 04:38:22,331 INFO    MainThread:17882 [wandb_run.py:_restore():2520] restore
2025-05-11 04:38:22,332 INFO    MainThread:17882 [wandb_run.py:_restore():2526] restore done
2025-05-11 04:38:22,799 INFO    MainThread:17882 [wandb_run.py:_footer_history_summary_info():4188] rendering history
2025-05-11 04:38:22,799 INFO    MainThread:17882 [wandb_run.py:_footer_history_summary_info():4220] rendering summary
2025-05-11 04:38:22,800 INFO    MainThread:17882 [wandb_run.py:_footer_sync_info():4149] logging synced files
